<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Get Code</title>

    <!-- Bootstrap -->
    <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">


  </head>
  <body>
   
<div class="navbar navbar-default">
  <div class="container">
    <a class="navbar-brand" href="#">Brand</a>
    <ul class="nav navbar-nav">
      <li class="active"><a href="#">Home</a></li>
      <li><a href="#">Link</a></li>
      <li><a href="#">Link</a></li>
      <li class="divider-vertical"></li>
      <li><a href="#">More</a></li>
      <li><a href="#">Options</a></li>
    </ul>
  </div>
</div>

<div class="container">
    <div class="jumbotron text-center">
      
      
      <!-- cupon image -->
      <div class="row">
          <div class="col-md-8">
          </div> 
        <div class="container col-md-4">
        	<div class="qr"></div> 
          <div class="code"></div> 
          
            
        </div>
     </div>
   </div>
</div> 

<!--   
  <div class="row">
    <div class="col-lg-6">
      <h4>Mobile First</h4>
      <p>Responsive by default, and a clean "flat" design.</p>
      
      <h4>Powerful Grid</h4>
      <p>3 responsive grid sizes to control the grid layout on tiny, small and large displays.</p>
    </div>
    
    <div class="col-lg-6">
      <h4>New Elements</h4>
      <p>New panels, list groups, glyphicons and justified navigation.</p>
      
      <h4>Less Bloat</h4>
      <p>The optimized CSS is in a single file. Glyphicons are now separate.</p>
    </div>
  </div> -->
  
</div> <!-- /container -->

    <script type="text/javascript" src="http://www.parsecdn.com/js/parse-1.2.18.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>

    <script type="text/javascript">
       $(document).ready(function(){  
    Parse.initialize("yCot7DiqPN7MLHrmceO3kR5C8FzxPFLqynLBgc4A", "ffJ4m7XXPcVpQAJL3Jw212KbNn06Lp098Fl468Tx");

    var Codes = Parse.Object.extend("Codes");
    var query = new Parse.Query(Codes);
    var idd;
    
    query.equalTo("voucherId", parseInt(localStorage.getItem("ID")))  ;
    query.equalTo("taken", false)  ;
   
    query.limit(1);
    query.find({
      success: function(object){
        // console.log(object.length) ;
       
        $(".qr").append("<img src='https://api.qrserver.com/v1/create-qr-code/?size=150x150&data="+object[0].id+"'>");
        $(".code").append(object[0].id);
        // object[0].set("used",true);
        // object[0].save();
//           
        
      },          
        error: function(error) {
                console.log("An error occured :(");
            }
        });
      query.first({
      success: function(object) {

     object.set("taken", true);
     object.save();


  },
  error: function(error) {
    alert("Err or: " + error.code + " " + error.message);
  }
});
        
     
    });

    </script>
  </body>
</html>